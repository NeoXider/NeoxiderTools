# Менеджер денег (Money)

## 1. Введение

`Money` — это централизованный компонент (Singleton) для управления всеми денежными операциями в игре. Он позволяет легко отслеживать основной баланс игрока, а также деньги, заработанные за текущий уровень. Компонент автоматически сохраняет прогресс и предоставляет удобные события для обновления UI, что делает его надежной основой для экономики вашей игры.

---

## 2. Описание класса

### Money
- **Пространство имен**: `Neo.Shop`
- **Путь к файлу**: `Assets/Neoxider/Scripts/Shop/Money.cs`
- **Наследуется от**: `Singleton<Money>`, `IMoneySpend`, `IMoneyAdd`

**Описание**:
Синглтон для управления всеми денежными операциями в игре. Он отслеживает общие деньги игрока, деньги, заработанные за уровень, и предоставляет методы для их изменения и сохранения.

### Ключевые особенности
- **Синглтон**: Легкий доступ к экземпляру класса из любой точки кода через `Money.I`.
- **Два типа баланса**: Управляет общим количеством денег (`money`) и деньгами, заработанными за текущий уровень (`levelMoney`).
- **Сохранение и загрузка**: Автоматически сохраняет и загружает количество денег с помощью `PlayerPrefs`.
- **Интерфейсы**: Реализует `IMoneySpend` и `IMoneyAdd` для стандартизации операций траты и добавления денег.
- **События**: Предоставляет `UnityEvent` для отслеживания изменений баланса.
- **Автоматическое обновление UI**: Может напрямую обновлять массивы `TMP_Text` и `SetText` при изменении баланса.

---

## 3. Настройки в инспекторе

- `_roundToDecimal` (`int`): Количество знаков после запятой, до которого будет округляться отображаемое значение денег.
- `st_levelMoney` (`SetText[]`): Массив компонентов `SetText`, которые будут автоматически обновляться значением `levelMoney`.
- `st_money` (`SetText[]`): Массив компонентов `SetText`, которые будут автоматически обновляться значением `money`.
- `t_levelMoney` (`TMP_Text[]`): Массив компонентов `TextMeshPro`, которые будут автоматически обновляться значением `levelMoney`.
- `t_money` (`TMP_Text[]`): Массив компонентов `TextMeshPro`, которые будут автоматически обновляться значением `money`.

---

## 4. Публичные свойства и поля

- `levelMoney` (`float`): Количество денег, заработанных за текущий уровень. Только для чтения.
- `money` (`float`): Текущий основной баланс игрока. Только для чтения.
- `allMoney` (`float`): Общее количество денег, заработанное за все время. Только для чтения.
- `LastChangeMoney` (`float`): Сумма последней транзакции (траты или получения). Только для чтения.

---

## 5. Публичные методы

- `Add(float amount)`: Добавляет указанное количество денег на основной баланс.
- `Spend(float amount)`: Пытается потратить указанное количество денег. Возвращает `bool` (`true` в случае успеха).
- `CanSpend(float count)`: Проверяет, достаточно ли денег на основном балансе для траты. Возвращает `bool`.
- `AddLevelMoney(float count)`: Добавляет указанное количество денег к балансу текущего уровня.
- `SetLevelMoney(float count)`: Устанавливает баланс текущего уровня в указанное значение. Возвращает `float` (предыдущее значение `levelMoney`).
- `SetMoneyForLevel(bool resetLevelMoney)`: Переводит все деньги, заработанные за уровень, на основной баланс. Если `resetLevelMoney` равно `true`, обнуляет `levelMoney`.

---

## 6. Unity Events

- `OnChangedLevelMoney`: Вызывается при изменении денег, заработанных за уровень. Передает `float` (новое значение `levelMoney`).
- `OnChangedMoney`: Вызывается при изменении основного баланса. Передает `float` (новое значение `money`).
- `OnChangeLastMoney`: Вызывается при любом изменении баланса. Передает `float` (сумма последнего изменения).
- `OnChangeAllMoney`: Вызывается при добавлении денег. Передает `float` (общая сумма заработанных денег за все время).
