# Chance System Behaviour

`ChanceSystemBehaviour` — компонент сцены, который оборачивает `ChanceManager`. Даёт возможность редактировать шансы прямо в инспекторе, опционально брать их из `ChanceData` и получать результат через UnityEvent.

---

## Ключевые особенности
- инлайн-редактор списка шансов (веса, названия, флаг `Locked`, авто-нормализация);
- загрузка конфигурации из `ChanceData` при запуске;
- событие `OnIdGenerated (UnityEvent<int>)` для быстрого связывания с логикой;
- флажок **Log Debug Once** в инспекторе: при включении (только в редакторе) следующая валидация логирует выбранную запись и её вероятность, затем флажок сбрасывается.

---

## Поля
- **Manager** — сериализованный `ChanceManager` со всеми настройками.
- **Chance Data** — опциональный ScriptableObject; если указан, его конфигурация копируется в `Awake`.
- **Log Debug Once** — триггер одноразового логирования результата.
- **On Id Generated** — событие, получающее выбранный индекс.

---

## Основные методы
- `GenerateId()` — вычисляет результат и вызывает UnityEvent.
- `int GetId()` — возвращает выбранный индекс без вызова события.
- `ChanceManager.Entry Evaluate()` — отдаёт запись (ID, вес, locked и т.д.).
- `AddChance / SetChance / RemoveChance / ClearChances / Normalize` — прокси к методам `ChanceManager`.

---

## Быстрый сценарий
1. Добавьте компонент на `GameObject`.
2. Разверните **Manager**, настроив веса, подписи и флажки `Locked` для фиксированных значений.
3. При необходимости подключите `ChanceData` или оставьте конфигурацию локальной.
4. Подпишите `OnIdGenerated` или вызывайте `GenerateId()`/`Evaluate()` из другого скрипта.
5. Для отладки установите `Log Debug Once` — в следующей валидации в консоль попадёт ID и нормализованная вероятность.

---

## Полезно знать
- Компонент вызывает `Sanitize()` и `EnsureUniqueIds()` на `Awake` и `OnValidate`.
- Можно задать собственный генератор случайных чисел: `Manager.RandomProvider = () => (float)systemRandom.NextDouble();`.
- Поведение нормализации контролируется самим `ChanceManager` (см. соответствующий документ).

Дополнительные сведения о структуре записей — в документе **Chance Manager**.
