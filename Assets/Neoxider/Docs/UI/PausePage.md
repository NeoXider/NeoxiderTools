# Компонент PausePage

## 1. Введение

`PausePage` — компонент для управления паузой при активации GameObject (например, панели паузы). Все опции включены по желанию: масштаб времени, уведомление GM и управление курсором. При отключении восстанавливаются сохранённые `Time.timeScale` и состояние курсора, поэтому компонент не конфликтует с `CursorLockController` и `PlayerController3DPhysics` / `PlayerController2DPhysics`.

---

## 2. Описание класса

### PausePage

- **Пространство имён**: `Neo.Tools`
- **Путь**: `Assets/Neoxider/Scripts/UI/PausePage.cs`

**Поведение**

- При **OnEnable**: по опциям — выставляет `Time.timeScale`, вызывает `GM.I?.Pause()`, при включённом управлении курсором сохраняет текущее состояние курсора и показывает/разблокирует его.
- При **OnDisable**: восстанавливает прежний `Time.timeScale`, вызывает `GM.I?.Resume()` и при управлении курсором либо принудительно блокирует курсор (**Lock Cursor On Resume** = true), либо восстанавливает сохранённое состояние.

**Параметры**

| Параметр | Описание |
|----------|----------|
| **Time / Use Time Scale** | Включить изменение `Time.timeScale` при паузе и восстановление при снятии. |
| **Time Scale On Pause** | Значение `Time.timeScale` во время паузы (0 = полная пауза). |
| **Game Manager / Send Pause** | Вызывать `GM.I.Pause()` при включении и `GM.I.Resume()` при выключении. |
| **Cursor / Control Cursor** | Показывать и разблокировать курсор при паузе; при снятии паузы — см. Lock Cursor On Resume. |
| **Cursor / Lock Cursor On Resume** | По умолчанию **включено**: при закрытии паузы курсор всегда блокируется и скрывается (рекомендуется для FPS и вращения камеры). Если выключено — восстанавливается состояние на момент открытия паузы (если до открытия паузы ESC уже разблокировал курсор, без этой опции камера после возврата в игру не вращалась бы). |

**Анимации**

В `OnValidate` компонент ищет `Animator` на том же объекте и выставляет `updateMode = UnscaledTime`, чтобы анимации UI шли во время паузы.

**Публичные методы**

Нет методов для вызова из кода; настройка только через Inspector.

---

## 3. Совместная работа с курсором и контроллерами

- **CursorLockController**: при ESC часто сначала разблокируется курсор, затем открывается панель паузы — сохранённое состояние уже «разблокировано», и без **Lock Cursor On Resume** после закрытия меню курсор оставался бы видимым и камера не вращалась бы. Оставьте **Lock Cursor On Resume** включённым (по умолчанию), чтобы при закрытии паузы курсор снова блокировался.
- **PlayerController3DPhysics** / **PlayerController2DPhysics**: при `_pauseLookWhenCursorVisible` вращение камеры отключено, пока курсор видим. После возврата из меню курсор должен быть снова заблокирован — для этого и нужен **Lock Cursor On Resume** в PausePage.

---

## 4. Быстрый сценарий

1. Добавьте `PausePage` на GameObject панели паузы (часто отключена по умолчанию).
2. Включите нужные опции: **Use Time Scale**, **Send Pause**, при необходимости **Control Cursor**.
3. При показе панели (SetActive(true)) пауза и курсор (если включено) применяются; при скрытии — восстанавливаются.
